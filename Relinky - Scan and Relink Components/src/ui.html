<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Relinky - Scan and Relink Components</title>
    <!-- Vue.js from CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <!-- The ui.js script will be injected by webpack -->
  </head>

<body>
  <!-- Loading indicator -->
  <div id="loading" style="display: flex; justify-content: center; align-items: center; height: 100vh;">
    Loading...
  </div>
  <!-- Main app -->
  <div id="app">
    <div v-cloak class="plugin-container">
      <div class="content-section">
        <!-- Tab Navigation -->
        <div class="tab-navigation">
          <button 
            class="tab-button" 
            :class="{ 
              'active': activeTab === 'tokens',
              'inactive': activeTab !== 'tokens'
            }"
            @click="switchTab('tokens')"
          >
            <span>Relink</span>
          </button>
          <button 
            class="tab-button" 
            :class="{ 
              'active': activeTab === 'library-tokens',
              'inactive': activeTab !== 'library-tokens'
            }"
            @click="switchTab('library-tokens')"
          >
            <div class="tab-label">
              <span>Unlink</span>
              <span class="beta-badge">BETA</span>
            </div>
            <span v-if="inactiveLibraryTokens.length" class="tab-badge">
              {{ inactiveLibraryTokens.length }}
            </span>
          </button>
      </div>

      <!-- Section content -->
      <div class="scan-section">
          <div class="step-container">
            <div class="step-content">
              <!-- 1. Title and Watch button -->
              <div class="step-header">
                <h3 class="step-title">Select frames or components</h3>
                <button 
                  class="watch-toggle" 
                  :class="{ 
                    active: isWatching,
                    disabled: !scanEntirePage 
                  }"
                  @click="toggleWatch"
                  :disabled="!scanEntirePage"
                  :title="watchButtonTitle"
                >
                  <div class="watch-toggle-content">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                      <path v-if="isWatching && scanEntirePage" d="M8 3.33333C11.3333 3.33333 14.1667 5.33333 15.3333 8C14.1667 10.6667 11.3333 12.6667 8 12.6667C4.66667 12.6667 1.83333 10.6667 0.666667 8C1.83333 5.33333 4.66667 3.33333 8 3.33333Z" fill="currentColor"/>
                      <g v-else>
                        <path d="M2.66667 2L13.3333 14" stroke="currentColor" stroke-width="1.5"/>
                        <path d="M8 3.33333C11.3333 3.33333 14.1667 5.33333 15.3333 8C14.1667 10.6667 11.3333 12.6667 8 12.6667C4.66667 12.6667 1.83333 10.6667 0.666667 8C1.83333 5.33333 4.66667 3.33333 8 3.33333Z" fill="currentColor" fill-opacity="0.5"/>
                      </g>
                    </svg>
                    <span class="watch-toggle-text">{{ isWatching && scanEntirePage ? 'Watching' : 'Watch changes' }}</span>
                  </div>
                </button>
              </div>

              <!-- 2. Scan Settings dropdown (move this before selection status) -->
              <div class="scan-settings">
                <div class="settings-header">
                  <h4 class="settings-title">Scan Settings</h4>
                  <button 
                    class="settings-toggle"
                    @click="showSettings = !showSettings"
                  >
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                      <path 
                        :d="showSettings 
                          ? 'M4 10L8 6L12 10' 
                          : 'M4 6L8 10L12 6'" 
                        stroke="currentColor" 
                        stroke-width="1.5" 
                        stroke-linecap="round" 
                        stroke-linejoin="round"
                      />
                    </svg>
                  </button>
                </div>
                
              <div class="settings-content" v-show="showSettings">
              <!-- Move Scan Entire Page here -->
                <div class="setting-item">
                    <label class="toggle-label">
                      <div class="toggle-label-content">
                        <span>Scan Entire Page</span>
                        <span v-if="scanEntirePage" class="slow-badge">slow</span>
                        <span class="info-badge" title="Scan the entire page instead of selected frames">ⓘ</span>
                      </div>
                      <div class="toggle-wrapper">
                        <input 
                          type="checkbox" 
                          v-model="scanEntirePage"
                          class="toggle-input"
                          @change="handleScanScopeChange"
                        >
                        <div class="toggle-slider"></div>
                      </div>
                    </label>
                </div>
                </div>
              </div>

              <!-- 3. Selection status -->
              <div class="selection-container">
                <!-- Warning for instances -->
                <div v-if="hasInstances" class="toast warning">
                  <div class="toast-icon">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                      <path fill-rule="evenodd" clip-rule="evenodd" d="M8 1.33337L14.6667 13.3334H1.33334L8 1.33337ZM8 4.00004L3.73334 12H12.2667L8 4.00004ZM7.33334 6.66671H8.66668V9.33337H7.33334V6.66671ZM7.33334 10.6667H8.66668V12H7.33334V10.6667Z" fill="currentColor"/>
                    </svg>
                  </div>
                  <span class="toast-message">Instances cannot be scanned. Please select frames, components, or sections instead.</span>
                </div>
                <!-- Existing selection messages -->
                <div v-else-if="!hasSelection && !scanEntirePage" class="toast">
                  <div class="toast-icon">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                      <path fill-rule="evenodd" clip-rule="evenodd" d="M8 1.33337L14.6667 13.3334H1.33334L8 1.33337ZM8 4.00004L3.73334 12H12.2667L8 4.00004ZM7.33334 6.66671H8.66668V9.33337H7.33334V6.66671ZM7.33334 10.6667H8.66668V12H7.33334V10.6667Z" fill="currentColor"/>
                    </svg>
                  </div>
                  <span class="toast-message">Select frames or sections to start scanning</span>
                </div>
                <div v-else-if="hasSelection && !scanEntirePage" class="toast success">
                  <div class="toast-icon">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                      <path fill-rule="evenodd" clip-rule="evenodd" d="M8 1.33334C4.31811 1.33334 1.33334 4.31811 1.33334 8C1.33334 11.6819 4.31811 14.6667 8 14.6667C11.6819 14.6667 14.6667 11.6819 14.6667 8C14.6667 4.31811 11.6819 1.33334 8 1.33334ZM11.0607 6.27274L7.39401 9.93941L5.27274 7.81814L6.06069 7.03019L7.39401 8.36351L10.2727 5.48479L11.0607 6.27274Z" fill="currentColor"/>
                    </svg>
                  </div>
                  <span class="toast-message">{{ selectedCount }} {{ selectedCount === 1 ? 'item' : 'items' }} selected</span>
                </div>
                </div>
              </div>
          </div>
      </div>
      <!-- divider -->
      <div class="divider"></div>
      <!-- Results section -->
      <div class="results-section">
        <!-- Design Tokens Tab -->
        <div v-if="activeTab === 'tokens'" class="tab-content">
          <!-- Scan Type Selection -->
          <div class="step-container">
            <div class="step-content">
              <!-- 1. Title -->
              <h3 class="step-title">Choose what to scan for</h3>

              <!-- 2. Scan Selection cards -->
              <div class="scan-cards">
                <div v-for="option in tokenScanOptions"
                     :key="option.value"
                     class="scan-card"
                     :class="{ 
                       'selected': selectedScanType === option.value,
                       'interactive': true
                     }"
                     role="option"
                     :aria-selected="selectedScanType === option.value"
                     tabindex="0"
                     @click="selectScanType(option.value)"
                >
                  <div class="scan-card-icon">
                    <div class="icon" v-html="icons[option.icon]"></div>
                  </div>
                  
                  <div class="scan-card-content">
                    <div class="scan-card-text">
                      <div class="scan-card-title">{{ option.label }}</div>
                      <div class="scan-card-description">{{ option.description }}</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Scan Controls -->
          <div class="divider"></div>

          <!-- Scanning Section - Following Hierarchy -->
          <div class="step-container">
            <div class="step-content">
              <!-- 1. Title -->
              <h3 class="step-title">Start scanning</h3>

              <!-- 2. Progress Bar -->
              <div class="progress-container">
                <div class="progress-bar">
                  <!-- Remove progress track -->
                  <div class="progress-fill" 
                       :style="{ 
                         width: `${scanProgress}%`,
                         background: getProgressBarColor('default')
                       }"
                  ></div>
                  <span class="progress-text" v-if="canStartScan || isScanning">{{ getProgressStatus() }}</span>
                </div>
              </div>

              <!-- 3. Buttons -->
              <div class="scan-buttons">
                <!-- Start/Rescan button -->
                <button 
                  v-if="!isScanning"
                  @click="startScan(showRescanButton)" 
                  class="button"
                  :class="{
                    'primary-button': !showRescanButton,
                    'secondary-button rescan': showRescanButton
                  }"
                  :disabled="!canStartScan"
                  :title="getStartScanButtonTitle()"
                >
                  {{ showRescanButton ? 'Rescan' : 'Start Scan' }}
                </button>
                
                <!-- Stop button - only show when actively scanning -->
                <button 
                  v-if="showStopButton"
                  @click="stopScan()" 
                  class="button warning-button"
                >
                  Stop
                </button>
              </div>
            </div>
          </div>

          <!-- Add a new section for scan results with consistent styling -->
          <template v-if="showScanResults">
            <div class="divider"></div>
            
            <div class="step-container">
              <div class="step-content">
                <!-- Results Header -->
                <div class="results-header">
                  <div class="step-title-with-badge">
                    <h3 class="step-title">Scan results</h3>
                    <span class="results-badge">{{ getTotalResultsCount() }}</span>
                  </div>
                  <div class="results-actions">
                    <!-- Add Hidden filter toggle -->
                    <button 
                      class="button secondary-button"
                      :class="{ 'active': showHiddenOnly }"
                      @click="toggleHiddenFilter"
                      title="Show hidden layers only"
                    >
                      Hidden
                      <span v-if="showHiddenOnly" class="icon-check">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <g id="check">
                            <path d="M20 6L9 17L4 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                          </g>
                        </svg>
                      </span>
                    </button>
                    <button 
                      class="button secondary-button"
                      @click="clearResults"
                    >
                      Clear
                    </button>
                  </div>
                </div>

                <!-- Results Container -->
                <div class="results-container">
                  <div v-for="(group, groupKey) in filteredResults" 
                       :key="groupKey" 
                       class="value-group"
                  >
                    <!-- Group Header -->
                    <div class="value-group-header" 
                         @click="toggleGroup(groupKey)"
                         :class="{ 'expanded': isGroupExpanded(groupKey) }"
                    >
                      <div class="group-info">
                        <span class="expand-icon">
                          {{ isGroupExpanded(groupKey) ? '▼' : '▶' }}
                        </span>
                        <!-- Add typography-specific template -->
                        <template v-if="group.refs[0]?.type === 'typography'">
                          <div class="typography-labels">
                            <span class="label font-family" v-if="group.value.fontFamily">
                              {{ group.value.fontFamily }}
                            </span>
                            <span class="label font-weight" v-if="group.value.fontWeight">
                              {{ group.value.fontWeight }}
                            </span>
                            <span class="label font-size" v-if="group.value.fontSize">
                              {{ group.value.fontSize }}px
                            </span>
                          </div>
                        </template>
                        <!-- Keep existing templates for other types -->
                        <template v-else-if="group.refs[0]?.type === 'fill' || group.refs[0]?.type === 'stroke'">
                          <color-preview :color="group.value" />
                        </template>
                        <template v-else>
                          <div class="typography-labels">
                            <span class="label value">{{ formatValue(group.value) }}</span>
                            <span v-if="group.refs[0]?.type === 'gap'" class="label gap">{{ group.value }}px</span>
                            <span v-if="group.refs[0]?.type === 'verticalGap'" class="label vertical-gap">{{ group.value }}px</span>
                            <span v-if="group.refs[0]?.type === 'horizontalPadding'" class="label horizontal-padding">{{ group.value }}px</span>
                            <span v-if="group.refs[0]?.type === 'verticalPadding'" class="label vertical-padding">{{ group.value }}px</span>
                          </div>
                        </template>
                      </div>
                      <div class="group-actions">
                        <span class="label instance-count">{{ group.refs.length }}×</span>
                        <button 
                          class="button secondary-button"
                          @click.stop="selectGroup(group.refs, $event)"
                        >
                          Select All
                        </button>
                      </div>
                    </div>

                    <!-- Group Details -->
                    <div v-if="isGroupExpanded(groupKey)" 
                         class="value-group-details"
                         @click.stop
                    >
                      <div v-for="ref in group.refs" 
                           :key="ref.nodeId" 
                           class="reference-item"
                      >
                        <div class="reference-info">
                          <div class="reference-name">{{ ref.nodeName }}</div>
                          <div class="reference-location">{{ ref.location }}</div>
                        </div>
                        <button 
                          class="button secondary-button small"
                          @click="selectNode(ref.nodeId, $event)"
                        >
                          Select
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </template>
        </div>

          <!-- Unlinked Library Tab -->
          <div v-if="activeTab === 'library-tokens'" class="tab-content library-tokens-content">
            <!-- Loading State -->
            <div v-if="isLoadingVariables" class="loading-state">
              <div class="loading-spinner"></div>
              <span>Loading variables...</span>
            </div>
            
            <!-- Variables Content -->
            <div v-else class="variables-section">
              <!-- Step 1: Select Variable Types -->
              <div class="step-container">
                <div class="step-content">
                  <h3 class="step-title">Choose variable types to scan</h3>
                  
                  <!-- Variable Type Selection Cards -->
                  <div class="scan-cards">
                    <div v-for="option in variableScanOptions"
                         :key="option.value"
                         class="scan-card"
                         :class="{ 
                           'selected': selectedVariableScanTypes.includes(option.value),
                           'interactive': true
                         }"
                         role="option"
                         :aria-selected="selectedVariableScanTypes.includes(option.value)"
                         tabindex="0"
                         @click="toggleVariableScanType(option.value)"
                    >
                      <div class="scan-card-icon">
                        <div class="icon" v-html="icons[option.icon]"></div>
                      </div>
                      
                      <div class="scan-card-content">
                        <div class="scan-card-text">
                          <div class="scan-card-title">{{ option.label }}</div>
                          <div class="scan-card-description">{{ option.description }}</div>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Scan Controls -->
                  <div class="progress-container">
                    <div class="progress-bar">
                      <div class="progress-fill" 
                           :style="{ 
                             width: `${variableScanProgress}%`,
                             background: getProgressBarColor('variables')
                           }"
                      ></div>
                      <span class="progress-text" v-if="canStartVariableScan || isVariableScanning">{{ getVariableProgressStatus() }}</span>
                    </div>
                  </div>
                  
                  <!-- Scan Button -->
                  <div class="scan-buttons">
                    <button 
                      v-if="!isVariableScanning"
                      @click="startVariableScan()" 
                      class="button primary-button"
                      :disabled="!canStartVariableScan"
                      title="Start scanning for variables"
                    >
                      {{ showRescanVariablesButton ? 'Rescan Variables' : 'Start Scan' }}
                    </button>
                    
                    <button 
                      v-if="isVariableScanning"
                      @click="stopVariableScan()" 
                      class="button warning-button"
                    >
                      Stop
                    </button>
                  </div>
                </div>
              </div>
              
              <!-- Divider between scan and results -->
              <div class="divider" v-if="showVariableScanResults"></div>
              
              <!-- Variable Results -->
              <div v-if="showVariableScanResults" class="step-container">
                <div class="step-content">
                  <!-- Results Header -->
                  <div class="results-header">
                    <div class="step-title-with-badge">
                      <h3 class="step-title">Variable scan results</h3>
                      <span class="results-badge">{{ linkedVariables.length }}</span>
                    </div>
                    
                    <!-- Filter Controls -->
                    <div class="filter-group">
                      <select v-model="variableFilters.type" class="filter-select">
                        <option value="all">All Types</option>
                        <option value="color">Colors</option>
                        <option value="number">Numbers</option>
                        <option value="string">Text</option>
                        <option value="boolean">Boolean</option>
                      </select>
                      <select v-model="variableFilters.collection" class="filter-select">
                        <option value="all">All Collections</option>
                        <option v-for="collection in variableCollections" 
                                :key="collection.id" 
                                :value="collection.id">
                          {{ collection.name }}
                        </option>
                      </select>
                      <input type="text" 
                             v-model="variableFilters.search" 
                             placeholder="Search variables..."
                             class="search-input">
                    </div>
                  </div>
                  
                  <!-- Grouped Variables List -->
                  <div class="variables-list">
                    <div v-for="(group, groupKey) in groupedVariables" 
                        :key="groupKey" 
                        class="value-group">
                      <!-- Group Header -->
                      <div class="value-group-header" 
                          @click="toggleGroup(groupKey)"
                          :class="{ 'expanded': isGroupExpanded(groupKey) }">
                        <div class="group-info">
                          <span class="expand-icon">
                            {{ isGroupExpanded(groupKey) ? '▼' : '▶' }}
                          </span>
                          <!-- Group name and count -->
                          <div class="typography-labels">
                            <span class="label variable-group-name">{{ group.collectionName }}</span>
                            <span class="label variable-type">{{ formatVariableType(group.type) }}</span>
                          </div>
                        </div>
                        <div class="group-actions">
                          <span class="label instance-count">{{ group.variables.length }}×</span>
                          <button 
                            class="button secondary-button"
                            @click.stop="selectAllVariablesInGroup(group.variables)"
                          >
                            Select All
                          </button>
                        </div>
                      </div>
                      
                      <!-- Group Variables -->
                      <div v-if="isGroupExpanded(groupKey)" 
                          class="value-group-details">
                        <div v-for="variable in group.variables" 
                             :key="variable.id" 
                             class="variable-card"
                             :class="{ 'selected': selectedVariableId === variable.id }">
                          <div class="variable-card-header">
                            <span class="variable-card-title">{{ variable.name }}</span>
                            <span class="variable-card-type">{{ formatVariableType(variable.type) }}</span>
                          </div>
                          <div class="variable-card-content">
                            <!-- Color Preview -->
                            <template v-if="variable.type === 'color'">
                              <div class="variable-preview">
                                <color-preview :color="variable.value" />
                              </div>
                            </template>
                            <!-- Other Types Preview -->
                            <template v-else>
                              <div class="variable-preview">
                                {{ formatVariableValue(variable.value, variable.type) }}
                              </div>
                            </template>
                          </div>
                          <div class="variable-card-actions">
                            <button 
                              class="button secondary-button small"
                              @click.stop="selectVariable(variable.id)"
                              title="Select nodes using this variable"
                            >
                              Select
                            </button>
                            <button 
                              class="button secondary-button small warning-button"
                              @click.stop="unlinkVariable(variable.id)"
                              title="Unlink this variable from all usages"
                            >
                              Unlink
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Empty State -->
                  <div v-if="linkedVariables.length === 0" class="empty-state">
                    <p>No linked variables found</p>
                    <p v-if="variableFilters.search || variableFilters.type !== 'all' || variableFilters.collection !== 'all'">
                      Try adjusting your filters
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
      </div>
      </div>

      <!-- Sticky footer -->
      <div class="sticky-footer">
        <div class="version-info">
          <span>v</span>
          <span class="version-number">1.3.0</span>
        </div>
        <!-- Add the new feedback button -->
        <div style="display: flex">
          <button 
            class="donate-button" 
            @click="openFeedbackForm" 
            title="feedback"
          >
            <span>📝</span>
          </button>
          <button class="donate-button" @click="openStripePayment">
            <span class="cat-icon">🐱</span>
            <span>Feed my cats</span>
          </button>
        </div>
        <div class="resize-handle"></div>
      </div>
    </div>
    <!-- Success Toast -->
    <div class="success-toast" 
      :class="{ 
        visible: showSuccessToast,
        warning: successMessage === 'Scanning the entire page may take longer'
      }"
      v-if="showSuccessToast">

      <div class="success-toast-content">
        <div class="success-toast-icon">
          <svg v-if="successMessage !== 'Scanning the entire page may take longer'" 
            width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M8 1.33334C4.31811 1.33334 1.33334 4.31811 1.33334 8C1.33334 11.6819 4.31811 14.6667 8 14.6667C11.6819 14.6667 14.6667 11.6819 14.6667 8C14.6667 4.31811 11.6819 1.33334 8 1.33334ZM11.0607 6.27274L7.39401 9.93941L5.27274 7.81814L6.06069 7.03019L7.39401 8.36351L10.2727 5.48479L11.0607 6.27274Z" fill="currentColor"/>
          </svg>
          <svg v-else width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M8 1L14.6667 13H1.33334L8 1ZM8 3.66667L3.73334 11.6667H12.2667L8 3.66667ZM7.33334 6H8.66668V8.66667H7.33334V6ZM7.33334 10H8.66668V11.3333H7.33334V10Z" fill="currentColor"/>
        </svg>
        </div>
        <span class="success-toast-message">{{ successMessage }}</span>
        <button class="success-toast-close" @click="dismissToast">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M12.6667 4.27337L11.7267 3.33337L8.00001 7.06004L4.27334 3.33337L3.33334 4.27337L7.06001 8.00004L3.33334 11.7267L4.27334 12.6667L8.00001 8.94004L12.6667 4.27337Z" fill="currentColor"/>
        </svg>
        </button>
      </div>
    </div>
    <!-- Add error toast component -->
    <div class="error-toast" v-if="showErrorToast">
      <div class="error-toast-content">
        <div class="error-toast-icon">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M8 1.33337L14.6667 13.3334H1.33334L8 1.33337ZM7.33334 6.66671H8.66668V9.33337H7.33334V6.66671ZM7.33334 10.6667H8.66668V12H7.33334V10.6667Z" fill="currentColor"/>
          </svg>
        </div>
        <span class="error-toast-message">{{ errorMessage }}</span>
        <button class="error-toast-close" @click="dismissErrorToast">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M12.6667 4.27337L11.7267 3.33337L8.00001 7.06004L4.27334 3.33337L3.33334 4.27337L7.06001 8.00004L3.33334 11.7267L4.27334 12.6667L8.00001 8.94004L12.6667 4.27337Z" fill="currentColor"/>
          </svg>
        </button>
      </div>
    </div>
  </div>
    <!-- Variables Content -->
  <div v-else class="variables-section">
    <!-- Filters -->
    <div class="variables-header">
      <div class="filter-group">
        <select v-model="variableFilters.type" class="filter-select">
          <option value="all">All Types</option>
          <option value="color">Colors</option>
          <option value="number">Numbers</option>
          <option value="string">Text</option>
          <option value="boolean">Boolean</option>
        </select>
        <select v-model="variableFilters.collection" class="filter-select">
          <option value="all">All Collections</option>
          <option v-for="collection in variableCollections" 
                  :key="collection.id" 
                  :value="collection.id">
            {{ collection.name }}
          </option>
        </select>
      </div>
      <input type="text" 
              v-model="variableFilters.search" 
              placeholder="Search variables..."
              class="search-input">
    </div>

    <!-- Variables List -->
    <div class="variables-list">
      <div v-for="variable in filteredVariables" 
            :key="variable.id" 
            class="variable-card"
            :class="{ 'selected': selectedVariableId === variable.id }"
            @click="selectVariable(variable.id)">
        <div class="variable-card-header">
          <span class="variable-card-title">{{ variable.name }}</span>
          <span class="variable-card-type">{{ variable.type }}</span>
        </div>
        <div class="variable-card-content">
          <!-- Color Preview -->
          <template v-if="variable.type === 'color'">
            <div class="variable-preview">
              <color-preview :color="variable.value" />
            </div>
          </template>
          <!-- Other Types Preview -->
          <template v-else>
            <div class="variable-preview">
              {{ variable.value }}
            </div>
          </template>
        </div>
      </div>
    </div>

    <!-- Empty State Results -->
    <div v-if="filteredVariables.length === 0" class="empty-state">
      <p>No variables found</p>
      <p v-if="variableFilters.search || variableFilters.type !== 'all' || variableFilters.collection !== 'all'">
        Try adjusting your filters
      </p>
    </div>
  </div>
</div>

  <!-- Add color preview template outside of style tag -->
  <template id="color-preview">
    <div class="color-preview">
      <div class="color-swatch-container">
        <div 
          class="color-swatch" 
          :style="{
            backgroundColor: `rgba(${color.r * 255}, ${color.g * 255}, ${color.b * 255}, ${color.a || 1})`
          }"
        ></div>
      </div>
      <div class="color-info">
        <span class="color-hex">RGB({{ Math.round(color.r * 255) }}, {{ Math.round(color.g * 255) }}, {{ Math.round(color.b * 255) }})</span>
        <span v-if="color.a !== 1" class="color-opacity">{{ Math.round(color.a * 100) }}%</span>
      </div>
    </div>
  </template>


</body>
</html>
